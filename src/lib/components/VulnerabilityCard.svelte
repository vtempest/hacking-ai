<script lang="ts">
	import { Card, CardContent, CardHeader, CardTitle } from '$lib/components/ui/card';
	import { Badge } from '$lib/components/ui/badge';
	import type { VulnerabilityData } from '$lib/data/dashboard';

	export let vulnerability: VulnerabilityData;

	function getRiskColor(level: string) {
		switch (level) {
			case 'Critical': return 'destructive';
			case 'High': return 'outline';
			case 'Medium': return 'secondary';
			case 'Low': return 'secondary';
			default: return 'secondary';
		}
	}

	function getBorderColor(level: string) {
		switch (level) {
			case 'Critical': return 'border-l-red-500';
			case 'High': return 'border-l-orange-500';
			case 'Medium': return 'border-l-yellow-500';
			case 'Low': return 'border-l-green-500';
			default: return 'border-l-gray-500';
		}
	}
</script>

<Card class="transition-all hover:shadow-md cursor-pointer border-l-4 {getBorderColor(vulnerability.riskLevel)}">
	<CardHeader class="pb-3">
		<div class="flex items-start justify-between">
			<div class="space-y-1">
				<div class="text-xs font-mono text-muted-foreground bg-muted px-2 py-1 rounded w-fit">
					{vulnerability.id}
				</div>
				<CardTitle class="text-lg">{vulnerability.title}</CardTitle>
			</div>
			<Badge variant={getRiskColor(vulnerability.riskLevel)}>
				{vulnerability.riskLevel}
			</Badge>
		</div>
	</CardHeader>
	<CardContent>
		<p class="text-sm text-muted-foreground mb-4">{vulnerability.description}</p>
		<div class="flex justify-between text-sm">
			<div class="text-center">
				<div class="text-xs text-muted-foreground uppercase tracking-wide">Prevalence</div>
				<div class="font-bold text-primary">{vulnerability.prevalence}%</div>
			</div>
			<div class="text-center">
				<div class="text-xs text-muted-foreground uppercase tracking-wide">Attack Success</div>
				<div class="font-bold text-primary">{vulnerability.attackSuccess}%</div>
			</div>
			<div class="text-center">
				<div class="text-xs text-muted-foreground uppercase tracking-wide">Category</div>
				<div class="font-bold text-primary text-xs">{vulnerability.category}</div>
			</div>
		</div>
	</CardContent>
</Card>